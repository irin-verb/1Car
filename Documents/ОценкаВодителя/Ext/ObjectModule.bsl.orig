 
Процедура ОбработкаПроведения(Отказ, Режим)
	Водитель = ЭтотОбъект.Водитель;	
<<<<<<< HEAD
	Запрос = Новый Запрос;
	//
=======
	Запрос = Новый Запрос;  
>>>>>>> irinka
    Запрос.Текст = 
    "ВЫБРАТЬ
    |   ОценкаВодителя.Оценка КАК Оценка
    |ИЗ
    |   Документ.ОценкаВодителя КАК ОценкаВодителя
    |ГДЕ
    |   ОценкаВодителя.Водитель = &Водитель";
    Запрос.УстановитьПараметр("Водитель", Водитель);
    РезультатЗапроса = Запрос.Выполнить();
    Выборка = РезультатЗапроса.Выбрать();
	
    СуммаОценок = 0;
    КоличествоОценок = 0;
    Пока Выборка.Следующий() Цикл
        СуммаОценок = СуммаОценок + Выборка.Оценка;
        КоличествоОценок = КоличествоОценок + 1;
    КонецЦикла;
    Если КоличествоОценок > 0 Тогда
        Рейтинг = СуммаОценок / КоличествоОценок;
    Иначе
        Рейтинг = 0;
    КонецЕсли;
	
	Движения.РейтингВодителей.Записывать = Истина;
	Движение = Движения.РейтингВодителей.Добавить();
	Движение.Водитель = Водитель;
    Движение.Рейтинг = Рейтинг;
	Движение.Период = ТекущаяДата();
КонецПроцедуры
    

